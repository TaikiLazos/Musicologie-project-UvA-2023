<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="author" content="Taiki Papandreou" />

<meta name="date" content="2023-01-01" />


<title>Bitterness in love music (K-pop vs J-pop)</title>

<meta property="og:title" content="Bitterness in love music (K-pop vs J-pop)" />

<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />

<link rel="icon" href="data:image/x-icon;" type="image/x-icon">


<script type="text/javascript">
window.FlexDashboardComponents = [];
</script>

<script src="index_files/header-attrs-2.20/header-attrs.js"></script>
<script src="index_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<link href="index_files/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="index_files/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="index_files/sly-1.6.1/sly.min.js"></script>
<script src="index_files/stickytableheaders-0.1.19/jquery.stickytableheaders.min.js"></script>
<link href="index_files/value-box-accent-static-0.6.1/theme-cosmo-value-box.css" rel="stylesheet" />
<link href="index_files/flexdashboard-css-0.6.1/flexdashboard.min.css" rel="stylesheet" />
<link href="index_files/flexdashboard-css-0.6.1/theme-cosmo.css" rel="stylesheet" />
<script src="index_files/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="index_files/plotly-binding-4.10.1/plotly.js"></script>
<script src="index_files/typedarray-0.1/typedarray.min.js"></script>
<link href="index_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="index_files/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="index_files/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="index_files/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="index_files/ionicons-2.0.1/css/ionicons.min.css" rel="stylesheet" />
<style type="text/css">
/*
  CSS for flexdashboard.js' use of Sly(). The sizing/position of this CSS needs to be
  applied _before_ flexdashboard.js initializes, which is why this CSS has been pulled
  out from flexdashboard.scss and inlined in the document's head.
*/

.storyboard-nav button {
  background: transparent;
  border: 0;
  opacity: .3;
  outline: none;
  padding: 0;
}

.storyboard-nav button:hover,
.storyboard-nav button:hover {
  opacity: .5;
}

.storyboard-nav button:disabled,
.storyboard-nav button:disabled {
  opacity: .1;
}

.storyboard-nav .sbnext,
.storyboard-nav .sbprev {
  float: left;
  width: 2%;
  height: 120px;
}

.storyboard-nav .sbprev {
  text-align: left;
  width: 2%;
}

.storyboard-nav .sbnext {
  float: right;
  text-align: right;
  margin-right: 8px;
}

.storyboard-nav .sbframelist {
  margin: 0 auto;
  width: 94%;
  height: 120px;
  overflow: hidden;
  text-shadow: none;
  margin-bottom: 8px;
}

.storyboard-nav .sbframelist ul {
  list-style: none;
  margin: 0;
  padding: 0;
  height: 100%;
}

.storyboard-nav .sbframelist ul li {
  float: left;
  width: 270px;
  height: 100%;
  padding: 10px 10px 10px 10px;
  margin-right: 8px;
  text-align: left;
  cursor: pointer;
}

.storyboard-nav .sbframelist ul li:last-child {
  margin-right: 0px;
}

.sbframe-commentary {
  width: 300px;
}

.sbframe-commentary ul {
  padding-left: 22px;
}

.sbframe.active {
  display: flex;
}

.sbframe:not(.active) {
  display: none;
}
@media only screen and (min-width: 768px) {
html, body {
  height: 100%;
}

#dashboard-container {
  height: 100%;
}
}
</style>



</head>

<body>

<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container-fluid">
<div class="navbar-header">

<span class="navbar-logo pull-left">
  
</span>
<span class="navbar-brand">
  Bitterness in love music (K-pop vs J-pop)
  <span class="navbar-author">
    Taiki Papandreou &mdash; 2023
    </span>
</span>

<button id="navbar-button" type="button" class="navbar-toggle collapsed pull-right" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>

</div>
<div id="navbar" class="navbar-collapse collapse">
<ul class="nav navbar-nav navbar-left">
</ul>
<ul class="nav navbar-nav navbar-right">
</ul>
</div><!--/.nav-collapse-->
</div><!--/.container-->
</div><!--/.navbar-->

<img class="mobile-figure" data-mobile-figure-id=fig1 src="index_files/figure-html/unnamed-chunk-3-1.mb.png" />
<img class="mobile-figure" data-mobile-figure-id=fig2 src="index_files/figure-html/unnamed-chunk-4-1.mb.png" />
<img class="mobile-figure" data-mobile-figure-id=fig3 src="index_files/figure-html/unnamed-chunk-7-1.mb.png" />
<img class="mobile-figure" data-mobile-figure-id=fig4 src="index_files/figure-html/unnamed-chunk-9-1.mb.png" />
<img class="mobile-figure" data-mobile-figure-id=fig5 src="index_files/figure-html/unnamed-chunk-10-1.mb.png" />
<img class="mobile-figure" data-mobile-figure-id=fig6 src="index_files/figure-html/unnamed-chunk-12-1.mb.png" />
<img class="mobile-figure" data-mobile-figure-id=fig7 src="index_files/figure-html/unnamed-chunk-13-1.mb.png" />
<img class="mobile-figure" data-mobile-figure-id=fig8 src="index_files/figure-html/unnamed-chunk-14-1.mb.png" />
<img class="mobile-figure" data-mobile-figure-id=fig9 src="index_files/figure-html/halloween-1.mb.png" />
<script type="text/javascript">


var FlexDashboard = (function () {

  // initialize options
  var _options = {};

  var FlexDashboard = function() {

    // default options
    _options = $.extend(_options, {
      theme: "cosmo",
      fillPage: false,
      orientation: 'columns',
      storyboard: false,
      defaultFigWidth: 576,
      defaultFigHeight: 461,
      defaultFigWidthMobile: 360,
      defaultFigHeightMobile: 461,
      isMobile: false,
      isPortrait: false,
      resize_reload: true
    });
  };

  function init(options) {

    // extend default options
    $.extend(true, _options, options);

    // add ids to sections that don't have them (pandoc won't assign ids
    // to e.g. sections with titles consisting of only chinese characters)
    var nextId = 1;
    $('.level1:not([id]),.level2:not([id]),.level3:not([id])').each(function() {
      $(this).attr('id', 'dashboard-' + nextId++);
    });

    // find navbar items
    var navbarItems = $('#flexdashboard-navbar');
    if (navbarItems.length)
      navbarItems = JSON.parse(navbarItems.html());
    addNavbarItems(navbarItems);

    // find the main dashboard container
    var dashboardContainer = $('#dashboard-container');

    // resolve mobile classes
    resolveMobileClasses(dashboardContainer);

    // one time global initialization for components
    componentsInit(dashboardContainer);

    // look for a global sidebar
    var globalSidebar = dashboardContainer.find(".section.level1.sidebar");
    if (globalSidebar.length > 0) {

      // global layout for fullscreen displays
      if (!isMobilePhone()) {

         // hoist it up to the top level
         globalSidebar.insertBefore(dashboardContainer);

         // lay it out (set width/positions)
         layoutSidebar(globalSidebar, dashboardContainer);

      // tuck sidebar into first page for mobile phones
      } else {

        // convert it into a level3 section
        globalSidebar.removeClass('sidebar');
        globalSidebar.removeClass('level1');
        globalSidebar.addClass('level3');
        var h1 = globalSidebar.children('h1');
        var h3 = $('<h3></h3>');
        h3.append(h1.contents());
        h3.insertBefore(h1);
        h1.detach();

        // move it into the first page
        var page = dashboardContainer.find('.section.level1').first();
        if (page.length > 0)
          page.prepend(globalSidebar);
      }
    }

    // look for pages to layout
    var pages = $('div.section.level1');
    if (pages.length > 0) {

        // find the navbar and collapse on clicked
        var navbar = $('#navbar');
        navbar.on("click", "a[data-toggle!=dropdown]", null, function () {
           navbar.collapse('hide');
        });

        // envelop the dashboard container in a tab content div
        dashboardContainer.wrapInner('<div class="tab-content"></div>');

        pages.each(function(index) {

          // lay it out
          layoutDashboardPage($(this));

          // add it to the navbar
          addToNavbar($(this), index === 0);

        });

    } else {

      // remove the navbar and navbar button if we don't
      // have any navbuttons
      if (navbarItems.length === 0) {
        $('#navbar').remove();
        $('#navbar-button').remove();
      }

      // add the storyboard class if requested
      if (_options.storyboard)
        dashboardContainer.addClass('storyboard');

      // layout the entire page
      layoutDashboardPage(dashboardContainer);
    }

    // if we are in shiny we need to trigger a window resize event to
    // force correct layout of shiny-bound-output elements
    if (isShinyDoc())
      $(window).trigger('resize');

    // make main components visible
    $('.section.sidebar').css('visibility', 'visible');
    dashboardContainer.css('visibility', 'visible');

    // handle location hash
    handleLocationHash();

    // intialize prism highlighting
    initPrismHighlighting();

    // record mobile and orientation state then register a handler
    // to refresh if resize_reload is set to true and it changes
    _options.isMobile = isMobilePhone();
    _options.isPortrait = isPortrait();
    if (_options.resize_reload) {
      $(window).on('resize', function() {
        if (_options.isMobile !== isMobilePhone() ||
            _options.isPortrait !== isPortrait()) {
          window.location.reload();
        }
      });
    } else {
      // if in desktop mode and resizing to mobile, make sure the heights are 100%
      // This enforces what `fillpage.css` does for "wider" pages.
      // Since we are not reloading once the page becomes small, we need to force the height to 100%
      // This is a new situation introduced when `_options.resize_reload` is `false`
      if (! _options.isMobile) {
        // only add if `fillpage.css` was added in the first place
        if (_options.fillPage) {
          // fillpage.css
          $("html,body,#dashboard").css("height", "100%");
        }
      }
    }
    // trigger layoutcomplete event
    dashboardContainer.trigger('flexdashboard:layoutcomplete');
  }

  function resolveMobileClasses(dashboardContainer) {
     // add top level layout class
    dashboardContainer.addClass(isMobilePhone() ? 'mobile-layout' :
                                                  'desktop-layout');

    // look for .mobile sections and add .no-mobile to their peers
    var mobileSections = $('.section.mobile');
    mobileSections.each(function() {
       var id = $(this).attr('id');
       var nomobileId = id.replace(/-\d+$/, '');
       $('#' + nomobileId).addClass('no-mobile');
    });
  }

  function addNavbarItems(navbarItems) {

    var navbarLeft = $('ul.navbar-left');
    var navbarRight = $('ul.navbar-right');

    for (var i = 0; i<navbarItems.length; i++) {

      // get the item
      var item = navbarItems[i];

      // determine the container
      var container = null;
      if (item.align === "left")
        container = navbarLeft;
      else
        container = navbarRight;

      // navbar menu if we have multiple items
      if (item.items) {
        var menu = navbarMenu(null, item.icon, item.title, container);
        for (var j = 0; j<item.items.length; j++) {
          var subItem = item.items[j];
          var li = $('<li></li>');
          var a = navbarLink(subItem.icon, subItem.title, subItem.href, subItem.target);
          a.removeClass("nav-link").addClass("dropdown-item");
          li.append(a);
          menu.append(li);
        }
      } else {
        var li = $('<li class="nav-item"></li>');
        li.append(navbarLink(item.icon, item.title, item.href, item.target));
        container.append(li);
      }
    }
  }

  // create or get a reference to an existing dropdown menu
  function navbarMenu(id, icon, title, container) {
    var existingMenu = [];
    if (id)
      existingMenu = container.children('#' + id);
    if (existingMenu.length > 0) {
      return existingMenu.children('ul');
    } else {
      var li = $('<li class="nav-item"></li>');
      if (id)
        li.attr('id', id);
      li.addClass('dropdown');
      // auto add "Share" title on mobile if necessary
      if (!title && icon && (icon === "fa-share-alt") && isMobilePhone())
        title = "Share";
      if (title) {
        title = title + ' <span class="caret"></span>';
      }
      var a = navbarLink(icon, title, "#");
      a.addClass('dropdown-toggle');
      a.attr('data-toggle', 'dropdown');
      a.attr('data-bs-toggle', 'dropdown');
      a.attr('role', 'button');
      a.attr('aria-expanded', 'false');
      li.append(a);
      var ul = $('<ul class="dropdown-menu"></ul>');
      ul.attr('role', 'menu');
      li.append(ul);
      container.append(li);
      return ul;
    }
  }

  function addToNavbar(page, active) {

    // capture the id and data-icon attribute (if any)
    var id = page.attr('id');
    var icon = page.attr('data-icon');
    var navmenu = page.attr('data-navmenu');

    // get hidden state (transfer this to navbar)
    var hidden = page.hasClass('hidden');
    page.removeClass('hidden');

    // sanitize the id for use with bootstrap tabs
    id = id.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_');
    page.attr('id', id);

    // get the wrapper
    var wrapper = page.closest('.dashboard-page-wrapper');

    // move the id to the wrapper
    page.removeAttr('id');
    wrapper.attr('id', id);

    // add the tab-pane class to the wrapper
    wrapper.addClass('tab-pane');
    if (active)
      wrapper.addClass('active');

    // get a reference to the h1, discover its inner contens, then detach it
    var h1 = wrapper.find('h1').first();
    var title = h1.contents();
    h1.detach();

    // create a navbar item
    var li = $('<li></li>');
    var a = navbarLink(icon, title, '#' + id);
    a.attr('data-toggle', 'tab');
    li.append(a);

    // add it to the navbar (or navbar menu if specified)
    var container = $('ul.navbar-left');
    if (navmenu) {
      var menuId = navmenu.replace(/\s+/g, '');
      var menu = navbarMenu(menuId, null, navmenu, container);
      li.find("> a").removeClass("nav-link").addClass("dropdown-item");
      menu.append(li);
    } else {
      li.addClass("nav-item")
      container.append(li);
    }

    // hide it if requested
    if (hidden)
      li.addClass('hidden');
  }

  function navbarLink(icon, title, href, target) {

    var a = $('<a class="nav-link"></a>');
    if (icon) {

      // get the name of the icon set and icon
      var dashPos = icon.indexOf("-");
      var iconSet = null;
      var iconSplit = icon.split(" ");
      if (iconSplit.length > 1) {
        iconSet = iconSplit[0];
        icon = iconSplit.slice(1).join(" ");
      } else {
        iconSet = icon.substring(0, dashPos);
      }
      var iconName = icon.substring(dashPos + 1);

      // create the icon
      var iconElement = $('<span class="' + iconSet + ' ' + icon + '"></span>');
      if (title)
        iconElement.css('margin-right', '7px');
      a.append(iconElement);
      // if href is null see if we can auto-generate based on icon (e.g. social)
      if (!href)
        maybeGenerateLinkFromIcon(iconName, a);
    }
    if (title)
      a.append(title);

    // add the href.
    if (href) {
      if (href === "source_embed") {
        a.attr('href', '#');
        a.attr('data-featherlight', "#flexdashboard-source-code");
        a.featherlight({
            beforeOpen: function(event){
              $('body').addClass('unselectable');
            },
            afterClose: function(event){
              $('body').removeClass('unselectable');
            }
        });
      } else {
        a.attr('href', href);
      }
    }

    // add the arget
    if (target)
      a.attr('target', target);

    return a;
  }

  // auto generate a link from an icon name (e.g. twitter) when possible
  function maybeGenerateLinkFromIcon(iconName, a) {

     var serviceLinks = {
      "twitter": "https://twitter.com/share?text=" + encodeURIComponent(document.title) + "&url="+encodeURIComponent(location.href),
      "facebook": "https://www.facebook.com/sharer/sharer.php?s=100&p[url]="+encodeURIComponent(location.href),
      "linkedin": "https://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(location.href) + "&title=" + encodeURIComponent(document.title),
      "pinterest": "https://pinterest.com/pin/create/link/?url="+encodeURIComponent(location.href) + "&description=" + encodeURIComponent(document.title)
    };

    var makeSocialLink = function(a, href) {
      a.attr('href', '#');
      a.on('click', function(e) {
        e.preventDefault();
        window.open(href);
      });
    };

    $.each(serviceLinks, function(key, value) {
      if (iconName.indexOf(key) !== -1)
        makeSocialLink(a, value);
    });
  }

  // layout a dashboard page
  function layoutDashboardPage(page) {

    // use a page wrapper so that free form content above the
    // dashboard appears at the top rather than the side (as it
    // would without the wrapper in a column orientation)
    var wrapper = $('<div class="dashboard-page-wrapper"></div>');
    page.wrap(wrapper);

    // if there are no level2 or level3 headers synthesize a level3
    // header to contain the (e.g. frame it, scroll container, etc.)
    var headers = page.find('h2,h3');
    if (headers.length === 0)
      page.wrapInner('<div class="section level3"></div>');

    // hoist up any content before level 2 or level 3 headers
    var children = page.children();
    children.each(function(index) {
      if ($(this).hasClass('level2') || $(this).hasClass('level3'))
        return false;
      $(this).insertBefore(page);
    });

    // determine orientation and fillPage behavior for distinct media
    var orientation, fillPage, storyboard;

    // media: mobile phone
    if (isMobilePhone()) {

      // if there is a sidebar we need to ensure it's content
      // is properly framed as an h3
      var sidebar = page.find('.section.sidebar');
      sidebar.removeClass('sidebar');
      sidebar.wrapInner('<div class="section level3"></div>');
      var h2 = sidebar.find('h2');
      var h3 = $('<h3></h3>');
      h3.append(h2.contents());
      h3.insertBefore(h2);
      h2.detach();

      // wipeout h2 elements then enclose them in a single h2
      var level2 = page.find('div.section.level2');
      level2.each(function() {
        level2.children('h2').remove();
        level2.children().unwrap();
      });
      page.wrapInner('<div class="section level2"></div>');

      // substitute mobile images
      if (isPortrait()) {
        var mobileFigures = $('img.mobile-figure');
        mobileFigures.each(function() {
          // get the src (might be base64 encoded)
          var src = $(this).attr('src');

          // find it's peer
          var id = $(this).attr('data-mobile-figure-id');
          var img = $('img[data-figure-id=' + id + "]");
          img.attr('src', src)
             .attr('width', _options.defaultFigWidthMobile)
             .attr('height', _options.defaultFigHeightMobile);
        });
      }

      // hoist storyboard commentary into it's own section
      if (page.hasClass('storyboard')) {
        var commentaryHR = page.find('div.section.level3 hr');
        commentaryHR.each(function() {
          var commentary = $(this).nextAll().detach();
          var commentarySection = $('<div class="section level3"></div>');
          commentarySection.append(commentary);
          commentarySection.insertAfter($(this).closest('div.section.level3'));
          $(this).remove();
        });
      }

      // force a non full screen layout by columns
      orientation = _options.orientation = 'columns';
      fillPage = _options.fillPage = false;
      storyboard = _options.storyboard = false;

    // media: desktop
    } else {

      // determine orientation
      orientation = page.attr('data-orientation');
      if (orientation !== 'rows' && orientation != 'columns')
        orientation = _options.orientation;

      // determine storyboard mode
      storyboard = page.hasClass('storyboard');

      // fillPage based on options (force for storyboard)
      fillPage = _options.fillPage || storyboard;

      // handle sidebar
      var sidebar = page.find('.section.level2.sidebar');
      if (sidebar.length > 0)
        layoutSidebar(sidebar, page);
    }

    // give it and it's parent divs height: 100% if we are in fillPage mode
    if (fillPage) {
      page.addClass('vertical-layout-fill');
      page.css('height', '100%');
      page.parents('div').css('height', '100%');
    } else {
      page.addClass('vertical-layout-scroll');
    }

    // perform the layout
    if (storyboard)
      layoutPageAsStoryboard(page);
    else if (orientation === 'rows')
      layoutPageByRows(page, fillPage);
    else if (orientation === 'columns')
      layoutPageByColumns(page, fillPage);
  }

  function layoutSidebar(sidebar, content) {

    // get it out of the header hierarchy
    sidebar = sidebar.first();
    if (sidebar.hasClass('level1')) {
      sidebar.removeClass('level1');
      sidebar.children('h1').remove();
    } else if (sidebar.hasClass('level2')) {
      sidebar.removeClass('level2');
      sidebar.children('h2').remove();
    }

    // determine width
    var sidebarWidth = isTablet() ? 220 : 250;
    var dataWidth = parseInt(sidebar.attr('data-width'));
    if (dataWidth)
      sidebarWidth = dataWidth;

    // set the width and shift the page right to accomodate the sidebar
    sidebar.css('width', sidebarWidth + 'px');
    content.css('padding-left', sidebarWidth + 'px');

    // wrap it's contents in a form
    sidebar.wrapInner($('<form></form>'));
  }

  function layoutPageAsStoryboard(page) {

    // create storyboard navigation
    var nav = $('<div class="storyboard-nav"></div>');

    // add navigation buttons
    var prev = $('<button class="sbprev"><i class="fa fa-angle-left"></i></button>');
    nav.append(prev);
    var next= $('<button class="sbnext"><i class="fa fa-angle-right"></i></button>');
    nav.append(next);

    // add navigation frame
    var frameList = $('<div class="sbframelist"></div>');
    nav.append(frameList);
    var ul = $('<ul></ul>');
    frameList.append(ul);

     // find all the level3 sections (those are the storyboard frames)
    var frames = page.find('div.section.level3');
    frames.each(function() {

      // mark it
      $(this).addClass('sbframe');

      // divide it into chart content and (optional) commentary
      $(this).addClass('dashboard-column-orientation');

      // stuff the chart into it's own div w/ flex
      $(this).wrapInner('<div class="sbframe-component"></div>');
      setFlex($(this), 1);
      var frame = $(this).children('.sbframe-component');

      // extract the title from the h3
      var li = $('<li></li>');
      var h3 = frame.children('h3');
      li.append(h3.contents());
      h3.detach();
      ul.append(li);

      // extract commentary
      var hr = frame.children('hr');
      if (hr.length) {
        var commentary = hr.nextAll().detach();
        hr.remove();
        var commentaryFrame = $('<div class="sbframe-commentary"></div>');
        commentaryFrame.addClass('flowing-content-shim');
        commentaryFrame.addClass('flowing-content-container');
        commentaryFrame.append(commentary);
        $(this).append(commentaryFrame);

        // look for a data-commentary-width attribute
        var commentaryWidth = $(this).attr('data-commentary-width');
        if (commentaryWidth)
          commentaryFrame.css('width', commentaryWidth + 'px');
      }

      // layout the chart (force flex)
      var result = layoutChart(frame, true);

      // ice the notes if there are none
      if (!result.notes)
        frame.find('.chart-notes').remove();

      // set flex on chart
      setFlex(frame, 1);
    });

    // create a div to hold all the frames
    var frameContent = $('<div class="sbframe-content"></div>');
    frameContent.addClass('dashboard-row-orientation');
    frameContent.append(frames.detach());

    // row orientation to stack nav and frame content
    page.addClass('dashboard-row-orientation');
    page.append(nav);
    page.append(frameContent);
    setFlex(frameContent, 1);

    // initialize sly
    var sly = new Sly(frameList, {
    		horizontal: true,
    		itemNav: 'basic',
    		smart: true,
    		activateOn: 'click',
    		startAt: 0,
    		scrollBy: 1,
    		activatePageOn: 'click',
    		speed: 200,
    		moveBy: 600,
    		dragHandle: true,
    		dynamicHandle: true,
    		clickBar: true,
    		keyboardNavBy: 'items',
    		next: next,
    		prev: prev
    	}).init();

    // make first frame active
    frames.removeClass('active');
    frames.first().addClass('active');

    // subscribe to frame changed events
    sly.on('active', function (eventName, itemIndex) {
      frames.removeClass('active');
      frames.eq(itemIndex).addClass('active')
                          .trigger('shown');
    });
  }

  function layoutPageByRows(page, fillPage) {

    // row orientation
    page.addClass('dashboard-row-orientation');

    // find all the level2 sections (those are the rows)
    var rows = page.find('div.section.level2');

    // if there are no level2 sections then treat the
    // entire page as if it's a level 2 section
    if (rows.length === 0) {
      page.wrapInner('<div class="section level2"></div>');
      rows = page.find('div.section.level2');
    }

    rows.each(function () {

      // flags
      var haveNotes = false;
      var haveFlexHeight = true;

      // remove the h2
      $(this).children('h2').remove();

      // check for a tabset
      var isTabset = $(this).hasClass('tabset');
      if (isTabset)
        layoutTabset($(this));

      // give it row layout semantics if it's not a tabset
      if (!isTabset)
        $(this).addClass('dashboard-row');

      // find all of the level 3 subheads
      var columns = $(this).find('div.section.level3');

      // determine figureSizes sizes
      var figureSizes = chartFigureSizes(columns);

      // fixup the columns
      columns.each(function(index) {

        // layout the chart (force flex if we are in a tabset)
        var result = layoutChart($(this), isTabset);

        // update flexHeight state
        if (!result.flex)
          haveFlexHeight = false;

        // update state
        if (result.notes)
          haveNotes = true;

        // set the column flex based on the figure width
        // (value boxes will just get the default figure width)
        var chartWidth = figureSizes[index].width;
        setFlex($(this), chartWidth + ' ' + chartWidth + ' 0px');

      });

      // remove empty chart note divs
      if (isTabset)
        $(this).find('.chart-notes').filter(function() {
            return $(this).html() === "&nbsp;";
        }).remove();
      if (!haveNotes)
        $(this).find('.chart-notes').remove();

       // make it a flexbox row
      if (haveFlexHeight)
        $(this).addClass('dashboard-row-flex');

      // now we can set the height on all the wrappers (based on maximum
      // figure height + room for title and notes, or data-height on the
      // container if specified). However, don't do this if there is
      // no flex on any of the constituent columns
      var flexHeight = null;
      var dataHeight = parseInt($(this).attr('data-height'));
      if (dataHeight)
        flexHeight = adjustedHeight(dataHeight, columns.first());
      else if (haveFlexHeight)
        flexHeight = maxChartHeight(figureSizes, columns);
      if (flexHeight) {
        if (fillPage)
          setFlex($(this), flexHeight + ' ' + flexHeight + ' 0px');
        else {
          $(this).css('height', flexHeight + 'px');
          setFlex($(this), '0 0 ' + flexHeight + 'px');
        }
      }

    });
  }

  function layoutPageByColumns(page, fillPage) {

    // column orientation
    page.addClass('dashboard-column-orientation');

    // find all the level2 sections (those are the columns)
    var columns = page.find('div.section.level2');

    // if there are no level2 sections then treat the
    // entire page as if it's a level 2 section
    if (columns.length === 0) {
      page.wrapInner('<div class="section level2"></div>');
      columns = page.find('div.section.level2');
    }

    // layout each column
    columns.each(function (index) {

      // remove the h2
      $(this).children('h2').remove();

      // make it a flexbox column
      $(this).addClass('dashboard-column');

      // check for a tabset
      var isTabset = $(this).hasClass('tabset');
      if (isTabset)
        layoutTabset($(this));

      // find all the h3 elements
      var rows = $(this).find('div.section.level3');

      // get the figure sizes for the rows
      var figureSizes = chartFigureSizes(rows);

      // column flex is the max row width (or data-width if specified)
      var flexWidth;
      var dataWidth = parseInt($(this).attr('data-width'));
      if (dataWidth)
        flexWidth = dataWidth;
      else
        flexWidth = maxChartWidth(figureSizes);
      setFlex($(this), flexWidth + ' ' + flexWidth + ' 0px');

      // layout each chart
      rows.each(function(index) {

        // perform the layout
        var result = layoutChart($(this), false);

        // ice the notes if there are none
        if (!result.notes)
          $(this).find('.chart-notes').remove();

        // set flex height based on figHeight, then adjust
        if (result.flex) {
          var chartHeight = figureSizes[index].height;
          chartHeight = adjustedHeight(chartHeight, $(this));
          if (fillPage)
            setFlex($(this), chartHeight + ' ' + chartHeight + ' 0px');
          else {
            $(this).css('height', chartHeight + 'px');
            setFlex($(this), chartHeight + ' ' + chartHeight + ' ' + chartHeight + 'px');
          }
        }
      });
    });
  }

  function chartFigureSizes(charts) {

    // sizes
    var figureSizes = new Array(charts.length);

    // check each chart
    charts.each(function(index) {

      // start with default
      figureSizes[index] = {
        width: _options.defaultFigWidth,
        height: _options.defaultFigHeight
      };

      // look for data-height or data-width then knit options
      var dataWidth = parseInt($(this).attr('data-width'));
      var dataHeight = parseInt($(this).attr('data-height'));
      var knitrOptions = $(this).find('.knitr-options:first');
      var knitrWidth, knitrHeight;
      if (knitrOptions) {
        knitrWidth = parseInt(knitrOptions.attr('data-fig-width'));
        knitrHeight =  parseInt(knitrOptions.attr('data-fig-height'));
      }

      // width
      if (dataWidth)
        figureSizes[index].width = dataWidth;
      else if (knitrWidth)
        figureSizes[index].width = knitrWidth;

      // height
      if (dataHeight)
        figureSizes[index].height = dataHeight;
      else if (knitrHeight)
        figureSizes[index].height = knitrHeight;
    });

    // return sizes
    return figureSizes;
  }

  function maxChartHeight(figureSizes, charts) {

    // first compute the maximum height
    var maxHeight = _options.defaultFigHeight;
    for (var i = 0; i<figureSizes.length; i++)
      if (figureSizes[i].height > maxHeight)
        maxHeight = figureSizes[i].height;

    // now add offests for chart title and chart notes
    if (charts.length)
      maxHeight = adjustedHeight(maxHeight, charts.first());

    return maxHeight;
  }

  function adjustedHeight(height, chart) {
    if (chart.length > 0) {
      var chartTitle = chart.find('.chart-title');
      if (chartTitle.length)
        height += chartTitle.first().outerHeight();
      var chartNotes = chart.find('.chart-notes');
      if (chartNotes.length)
        height += chartNotes.first().outerHeight();
    }
    return height;
  }

  function maxChartWidth(figureSizes) {
    var maxWidth = _options.defaultFigWidth;
    for (var i = 0; i<figureSizes.length; i++)
      if (figureSizes[i].width > maxWidth)
        maxWidth = figureSizes[i].width;
    return maxWidth;
  }

  // layout a chart
  function layoutChart(chart, forceFlex) {

    // state to return
    var result = {
      notes: false,
      flex: false
    };

    // extract the title
    var title = extractTitle(chart);

    // find components that apply to this container
    var components = componentsFind(chart);

    // if it's a custom component then call it and return
    var customComponents = componentsCustom(components);
    if (customComponents.length) {
      componentsLayout(customComponents, title, chart);
      result.notes = false;
      result.flex = forceFlex || componentsFlex(customComponents);
      return result;
    }

    // put all the content in a chart wrapper div
    chart.addClass('chart-wrapper');
    chart.wrapInner('<div class="chart-stage"></div>');
    var chartContent = chart.children('.chart-stage');

    // flex the content if appropriate
    result.flex = forceFlex || componentsFlex(components);
    if (result.flex) {
      // add flex classes
      chart.addClass('chart-wrapper-flex');
      chartContent.addClass('chart-stage-flex');

      // additional shim to break out of flexbox sizing
      chartContent.wrapInner('<div class="chart-shim"></div>');
      chartContent = chartContent.children('.chart-shim');
    }

    // set custom data-padding attribute
    var pad = chart.attr('data-padding');
    if (pad) {
      if (pad === "0")
        chart.addClass('no-padding');
      else {
        pad = pad + 'px';
        chartContent.css('left', pad)
                    .css('top', pad)
                    .css('right', pad)
                    .css('bottom', pad)
      }
    }

    // call compoents
    componentsLayout(components, title, chartContent);

    // also activate components on shiny output
    findShinyOutput(chartContent).on('shiny:value',
      function(event) {
        var element = $(event.target);
        setTimeout(function() {

          // see if we opted out of flex based on our output (for shiny
          // we can't tell what type of output we have until after the
          // value is bound)
          var components = componentsFind(element);
          var flex = forceFlex || componentsFlex(components);
          if (!flex) {
            chart.css('height', "");
            setFlex(chart, "");
            chart.removeClass('chart-wrapper-flex');
            chartContent.removeClass('chart-stage-flex');
            chartContent.children().unwrap();
          }

          // perform layout
          componentsLayout(components, title, element.parent());
        }, 10);
      });

    // add the title
    var chartTitle = $('<div class="chart-title"></div>');
    chartTitle.append(title);
    chart.prepend(chartTitle);

    // add the notes section
    var chartNotes = $('<div class="chart-notes"></div>');
    chartNotes.html('&nbsp;');
    chart.append(chartNotes);

    // attempt to extract notes if we have a component
    if (components.length)
      result.notes = extractChartNotes(chartContent, chartNotes);

    // return result
    return result;
  }

  // build a tabset from a section div with the .tabset class
  function layoutTabset(tabset) {

    // check for fade option
    var fade = tabset.hasClass("tabset-fade");
    var pills = tabset.hasClass("tabset-pills");
    var navClass = pills ? "nav-pills" : "nav-tabs";

    // determine the heading level of the tabset and tabs
    var match = tabset.attr('class').match(/level(\d) /);
    if (match === null)
      return;
    var tabsetLevel = Number(match[1]);
    var tabLevel = tabsetLevel + 1;

    // find all subheadings immediately below
    var tabs = tabset.find("div.section.level" + tabLevel);
    if (!tabs.length)
      return;

    // create tablist and tab-content elements
    var tabList = $('<ul class="nav ' + navClass + '" role="tablist"></ul>');
    $(tabs[0]).before(tabList);
    var tabContent = $('<div class="tab-content"></div>');
    $(tabs[0]).before(tabContent);

    // build the tabset
    var activeTab = 0;
    tabs.each(function(i) {

      // get the tab div
      var tab = $(tabs[i]);

      // get the id then sanitize it for use with bootstrap tabs
      var id = tab.attr('id');

      // see if this is marked as the active tab
      if (tab.hasClass('active'))
        activeTab = i;

      // sanitize the id for use with bootstrap tabs
      id = id.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_');
      tab.attr('id', id);

      // get the heading element within it and grab it's text
      var heading = tab.find('h' + tabLevel + ':first');
      var headingDom = heading.contents();

      // build and append the tab list item
      var a = $('<a role="tab" data-toggle="tab" class="nav-link"></a>');
      a.append(headingDom);
      a.attr('href', '#' + id);
      a.attr('aria-controls', id);
      var li = $('<li role="presentation" class="nav-item"></li>');
      li.append(a);
      tabList.append(li);

      // set it's attributes
      tab.attr('role', 'tabpanel');
      tab.addClass('tab-pane');
      tab.addClass('tabbed-pane');
      tab.addClass('no-title');
      if (fade)
        tab.addClass('fade');

      // move it into the tab content div
      tab.detach().appendTo(tabContent);
    });

    // set active tab
    $(tabList.children()[activeTab]).tab("show");
    var active = $(tabContent.children('div.section')[activeTab]);
    active.addClass('active');
    if (fade)
      active.addClass('in');

    // add nav-tabs-custom
    tabset.addClass('nav-tabs-custom');

    // internal layout is dashboard-column with tab-content flexing
    tabset.addClass('dashboard-column');
    setFlex(tabContent, 1);
  }

  // one time global initialization for components
  function componentsInit(dashboardContainer) {
    for (var i=0; i<window.FlexDashboardComponents.length; i++) {
      var component = window.FlexDashboardComponents[i];
      if (component.init)
        component.init(dashboardContainer);
    }
  }

  // find components that apply within a container
  function componentsFind(container) {

    // look for components
    var components = [];
    for (var i=0; i<window.FlexDashboardComponents.length; i++) {
      var component = window.FlexDashboardComponents[i];
      if (component.find(container).length)
        components.push(component);
    }

    // if there were none then use a special flowing content component
    // that just adds a scrollbar in fillPage mode
    if (components.length == 0) {
      components.push({
        find: function(container) {
          return container;
        },

        flex: function(fillPage) {
          return fillPage;
        },

        layout: function(title, container, element, fillPage) {
          if (fillPage) {
            container.addClass('flowing-content-shim');
            container.addClass('flowing-content-container');
          }
        }
      });
    }

    return components;
  }

  // if there is a custom component then pick it out
  function componentsCustom(components) {
    var customComponent = [];
    for (var i=0; i<components.length; i++)
      if (components[i].type === "custom") {
        customComponent.push(components[i]);
        break;
      }
    return customComponent;
  }

  // query all components for flex
  function componentsFlex(components) {

    // no components at all means no flex
    if (components.length === 0)
      return false;

    // otherwise query components (assume true unless we see false)
    var isMobile = isMobilePhone();
    for (var i=0; i<components.length; i++)
      if (components[i].flex && !components[i].flex(_options.fillPage))
        return false;
    return true;
  }

  // layout all components
  function componentsLayout(components, title, container) {
    var isMobile = isMobilePhone();
    for (var i=0; i<components.length; i++) {
      var element = components[i].find(container);
      if (components[i].layout) {
        // call layout (don't call other components if it returns false)
        var result = components[i].layout(title, container, element, _options.fillPage);
        if (result === false)
          return;
      }
    }
  }

  // get a reference to the h3, discover it's inner html, and remove it
  function extractTitle(container) {
    var h3 = container.children('h3').first();
    var title = '';
    if (!container.hasClass('no-title'))
      title = h3.contents();
    h3.detach();
    return title;
  }

  // extract chart notes
  function extractChartNotes(chartContent, chartNotes) {
    // look for a terminating blockquote or image caption
    var blockquote = chartContent.children('blockquote:last-child');
    var caption = chartContent.children('div.image-container')
                              .children('p.caption');
    if (blockquote.length) {
      chartNotes.empty().append(blockquote.children('p:first-child').contents());
      blockquote.remove();
      return true;
    } else if (caption.length) {
      chartNotes.empty().append(caption.contents());
      caption.remove();
      return true;
    } else {
      return false;
    }
  }

  function findShinyOutput(chartContent) {
    return chartContent.find('.shiny-text-output, .shiny-html-output');
  }

  // safely detect rendering on a mobile phone
  function isMobilePhone() {
    try
    {
      return ! window.matchMedia("only screen and (min-width: 768px)").matches;
    }
    catch(e) {
      return false;
    }
  }

  function isFillPage() {
    return _options.fillPage;
  }

  // detect portrait mode
  function isPortrait() {
    return ($(window).width() < $(window).height());
  }

  // safely detect rendering on a tablet
  function isTablet() {
    try
    {
      return window.matchMedia("only screen and (min-width: 769px) and (max-width: 992px)").matches;
    }
    catch(e) {
      return false;
    }
  }

  // test whether this is a shiny doc
  function isShinyDoc() {
    return (typeof(window.Shiny) !== "undefined" && !!window.Shiny.outputBindings);
  }

  // set flex using vendor specific prefixes
  function setFlex(el, flex) {
    el.css('-webkit-box-flex', flex)
      .css('-webkit-flex', flex)
      .css('-ms-flex', flex)
      .css('flex', flex);
  }

  // support bookmarking of pages
  function handleLocationHash() {

    // restore tab/page from bookmark
    var hash = window.decodeURIComponent(window.location.hash);
    if (hash.length > 0)
      $('ul.nav a[href="' + hash + '"]').tab('show');
    FlexDashboardUtils.manageActiveNavbarMenu();

    // navigate to a tab when the history changes
    window.addEventListener("popstate", function(e) {
      var hash = window.decodeURIComponent(window.location.hash);
      var activeTab = $('ul.nav a[href="' + hash + '"]');
      if (activeTab.length) {
        activeTab.tab('show');
      } else {
        $('ul.nav a:first').tab('show');
      }
      FlexDashboardUtils.manageActiveNavbarMenu();
    });

    // add a hash to the URL when the user clicks on a tab/page
    $('.navbar-nav a[data-toggle="tab"]').on('click', function(e) {
      var baseUrl = FlexDashboardUtils.urlWithoutHash(window.location.href);
      var hash = FlexDashboardUtils.urlHash($(this).attr('href'));
      var href = baseUrl + hash;
      FlexDashboardUtils.setLocation(href);
    });

    // handle clicks of other links that should activate pages
    var navPages = $('ul.navbar-nav li a[data-toggle=tab]');
    navPages.each(function() {
      var href =  $(this).attr('href');
      var links = $('a[href="' + href + '"][data-toggle!=tab]');
      links.each(function() {
        $(this).on('click', function(e) {
          window.FlexDashboardUtils.showPage(href);
        });
      });
    });
  }

  // tweak Prism highlighting
  function initPrismHighlighting() {

    if (window.Prism) {
      Prism.languages.insertBefore('r', 'comment', {
        'heading': [
          {
            // title 1
        	  // =======

        	  // title 2
        	  // -------
        	  pattern: /\w+.*(?:\r?\n|\r)(?:====+|----+)/,
            alias: 'operator'
          },
          {
            // ### title 3
            pattern: /(^\s*)###[^#].+/m,
            lookbehind: true,
            alias: 'operator'
          }
        ]
      });

      // prism highlight
      Prism.highlightAll();
    }
  }

  FlexDashboard.prototype = {
    constructor: FlexDashboard,
    init: init,
    isMobilePhone: isMobilePhone,
    isFillPage: isFillPage
  };

  return FlexDashboard;

})();

// utils
window.FlexDashboardUtils = {
  resizableImage: function(img) {
    var src = img.attr('src');
    var url = 'url("' + src + '")';
    img.parent().css('background', url)
                .css('background-size', 'contain')
                .css('background-repeat', 'no-repeat')
                .css('background-position', 'center')
                .addClass('image-container');
  },
  setLocation: function(href) {
    if (history && history.pushState) {
      history.pushState(null, null, href);
    } else {
      window.location.replace(href);
    }
    setTimeout(function() {
        window.scrollTo(0, 0);
    }, 10);
    this.manageActiveNavbarMenu();
  },
  showPage: function(href) {
    $('ul.navbar-nav li a[href="' + href + '"]').tab('show');
    var baseUrl = this.urlWithoutHash(window.location.href);
    var loc = baseUrl + href;
    this.setLocation(loc);
  },
  showLinkedValue: function(href) {
    // check for a page link
    if ($('ul.navbar-nav li a[data-toggle=tab][href="' + href + '"]').length > 0)
      this.showPage(href);
    else
      window.open(href);
  },
  urlWithoutHash: function(url) {
    var hashLoc = url.indexOf('#');
    if (hashLoc != -1)
      return url.substring(0, hashLoc);
    else
      return url;
  },
  urlHash: function(url) {
    var hashLoc = url.indexOf('#');
    if (hashLoc != -1)
      return url.substring(hashLoc);
    else
      return "";
  },
  manageActiveNavbarMenu: function () {
    // remove active from currently active tabs
    $('.navbar ul.nav .active').removeClass('active');
    // find the active tab
    var activeTab = $('.dashboard-page-wrapper.tab-pane.active');
    if (activeTab.length > 0) {
      var tabId = activeTab.attr('id');
      if (tabId)
        $(".navbar ul.nav a[href='#" + tabId + "']").tab("show");
    }
  }
};

window.FlexDashboard = new FlexDashboard();

// empty content
window.FlexDashboardComponents.push({
  find: function(container) {
    if (container.find('p').length == 0)
      return container;
    else
      return $();
  }
})

// plot image
window.FlexDashboardComponents.push({

  find: function(container) {
    return container.children('p')
                    .children('img:only-child');
  },

  layout: function(title, container, element, fillPage) {
    FlexDashboardUtils.resizableImage(element);
  }
});

// plot image (figure style)
window.FlexDashboardComponents.push({

  find: function(container) {
    return container.children('div.figure').children('img');
  },

  layout: function(title, container, element, fillPage) {
    FlexDashboardUtils.resizableImage(element);
  }
});

// htmlwidget
window.FlexDashboardComponents.push({

  init: function(dashboardContainer) {
    // trigger "shown" after initial layout to force static htmlwidgets
    // in runtime: shiny to be resized after the dom has been transformed
    dashboardContainer.on('flexdashboard:layoutcomplete', function(event) {
      setTimeout(function() {
        dashboardContainer.trigger('shown');
      }, 200);
    });
  },

  find: function(container) {
    return container.children('div[id^="htmlwidget-"],div.html-widget');
  }
});

// gauge
window.FlexDashboardComponents.push({

  find: function(container) {
    return container.children('div.html-widget.gauge');
  },

  flex: function(fillPage) {
    return false;
  },

  layout: function(title, container, element, fillPage) {


  }

});

// shiny output
window.FlexDashboardComponents.push({
  find: function(container) {
    return container.children('div[class^="shiny-"]');
  }
});

// bootstrap table
window.FlexDashboardComponents.push({

  find: function(container) {
    var bsTable = container.find('table.table');
    if (bsTable.length !== 0)
      return bsTable;
    else
      return container.find('tr.header').parent('thead').parent('table');
  },

  flex: function(fillPage) {
    return fillPage;
  },

  layout: function(title, container, element, fillPage) {

    // alias variables
    var bsTable = element;

    // fixup xtable generated tables with a proper thead
    var headerRow = bsTable.find('tbody > tr:first-child > th').parent();
    if (headerRow.length > 0) {
      var thead = $('<thead></thead>');
      bsTable.prepend(thead);
      headerRow.detach().appendTo(thead);
    }

    // improve appearance
    container.addClass('bootstrap-table');

    // for fill page provide scrolling w/ sticky headers
    if (fillPage) {
      // force scrollbar on overflow
      container.addClass('flowing-content-shim');

      // stable table headers when scrolling
      bsTable.stickyTableHeaders({
        scrollableArea: container
      });
    }
  }
});

// embedded shiny app
window.FlexDashboardComponents.push({

  find: function(container) {
    return container.find('iframe.shiny-frame');
  },

  flex: function(fillPage) {
    return fillPage;
  },

  layout: function(title, container, element, fillPage) {
    if (fillPage) {
      element.attr('height', '100%');
    } else {
      // provide default height if necessary
      var height = element.get(0).style.height;
      if (!height)
        height = element.attr('height');
      if (!height)
        element.attr('height', 500);
    }
  }
});

// shiny fillRow or fillCol
window.FlexDashboardComponents.push({

  find: function(container) {
    return container.find('.flexfill-container');
  },

  flex: function(fillPage) {
    return fillPage;
  },

  layout: function(title, container, element, fillPage) {
    if (fillPage)
      element.css('height', '100%');
    else {
      // provide default height if necessary
      var height = element.get(0).style.height;
      if (height === "100%" || height === "auto" || height === "initial" ||
          height === "inherit" || !height) {
        element.css('height', 500);
      }
    }
  }
});

// valueBox
window.FlexDashboardComponents.push({

  type: "custom",

  find: function(container) {
    if (container.find('span.value-output, .shiny-valuebox-output').length)
      return container;
    else
      return $();
  },

  flex: function(fillPage) {
    return false;
  },

  layout: function(title, container, element, fillPage) {

    // alias variables
    var chartTitle = title;
    var valueBox = element;

    // add value-box class to container
    container.addClass('value-box');

    // value paragraph
    var value = $('<p class="value"></p>');

    // if we have shiny-text-output then just move it in
    var valueOutputSpan = [];
    var shinyOutput = valueBox.find('.shiny-valuebox-output').detach();
    if (shinyOutput.length) {
      valueBox.children().remove();
      shinyOutput.html("&mdash;");
      value.append(shinyOutput);
    } else {
      // extract the value (remove leading vector index)
      var chartValue = valueBox.text().trim();
      chartValue = chartValue.replace("[1] ", "");
      valueOutputSpan = valueBox.find('span.value-output').detach();
      valueBox.children().remove();
      value.text(chartValue);
    }

    // caption
    var caption = $('<p class="caption"></p>');
    caption.append(chartTitle);

    // build inner div for value box and add it
    var inner = $('<div class="inner"></div>');
    inner.append(value);
    inner.append(caption);
    valueBox.append(inner);

    // add icon if specified
    var icon = $('<div class="icon"><i></i></div>');
    valueBox.append(icon);
    function setIcon(chartIcon) {
      var iconLib = "";
      var iconSplit = chartIcon.split(" ");
      if (iconSplit.length > 1) {
        iconLib = iconSplit[0];
        chartIcon = iconSplit.slice(1).join(" ");
      } else {
        var components = chartIcon.split("-");
        if (components.length > 1)
          iconLib = components[0];
      }
      icon.children('i').attr('class', iconLib + ' ' + chartIcon);
    }
    var chartIcon = valueBox.attr('data-icon');
    if (chartIcon)
      setIcon(chartIcon);

    // handle data attributes in valueOutputSpan
    function handleValueOutput(valueOutput) {

      // caption
      var dataCaption = valueOutput.attr('data-caption');
      if (dataCaption)
        caption.html(dataCaption);

      // icon
      var dataIcon = valueOutput.attr('data-icon');
      if (dataIcon)
        setIcon(dataIcon);

      // If valueBox(color=) was an accent color, this attr should
      // be populated with the accent color and the relevant CSS comes
      // in through HTML dependencies
      var dataColorAccent = valueOutput.attr('data-color-accent');
      var valueBoxClasses = "value-box-" + (["primary", "info", "danger", "warning", "success"].join(" value-box-"));
      if (dataColorAccent) {
        valueBox.removeClass(valueBoxClasses);
        valueBox.addClass('value-box-' + dataColorAccent);
      }

      // If valueBox(color=) was a CSS color, these other data-color-*
      // attrs will be populated
      var dataColor = valueOutput.attr('data-color');
      if (dataColor) {
        valueBox.removeClass(valueBoxClasses);
        valueBox.css('background-color', dataColor);
      }
      var dataColorText = valueOutput.attr('data-color-text');
      if (dataColorText) {
        valueBox.find(".inner").css('color', dataColorText);
      }
      var dataColorIcon = valueOutput.attr('data-color-icon');
      if (dataColorIcon) {
        valueBox.find(".icon").css('color', dataColorIcon);
      }

      // url
      var dataHref = valueOutput.attr('data-href');
      if (dataHref) {
        valueBox.addClass('linked-value');
        valueBox.off('click.value-box');
        valueBox.on('click.value-box', function(e) {
          window.FlexDashboardUtils.showLinkedValue(dataHref);
        });
      }
    }

    // check for a valueOutputSpan
    if (valueOutputSpan.length > 0) {
      handleValueOutput(valueOutputSpan);
    }

    // if we have a shinyOutput then bind a listener to handle
    // new valueOutputSpan values
    shinyOutput.on('shiny:value',
      function(event) {
        var element = $(event.target);
        setTimeout(function() {
          var valueOutputSpan = element.find('span.value-output');
          if (valueOutputSpan.length > 0)
            handleValueOutput(valueOutputSpan);
        }, 10);
      }
    );
  }
});
</script>

<div id="dashboard-container">

<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<style type="text/css">
.chart-wrapper .chart-stage {
    overflow-y: auto;
}
</style>
<div id="beginning-of-the-story" class="section level1 storyboard"
data-icon="ion-ios-home">
<h1 class="storyboard">Beginning of the story</h1>
<div id="welcome-to-my-portfolio" class="section level3">
<h3>Welcome to my portfolio!</h3>
<p><font size="6"> What is this about?</font></p>
<p>Music has always been an important medium for expressing emotions,
especially when it comes to matters of the heart. Romantic songs, in
particular, have a way of capturing the essence of love and heartbreak
in a way that resonates with people across cultures.</p>
<p>In this project, we aim to explore the question of who is more
romantic - Japanese or Korean artists? To do this, we will be analyzing
a playlist of 52 sad love songs compiled by an avid Spotify user and
self-proclaimed romantic, my brother.</p>
<p>Using R and various visualization tools, we will delve into the
playlist to gain insights into the different themes and styles of music
represented by the Japanese and Korean artists. Of course, being
romantic is a subjective concept, but we will be using my brother’s
taste in music as a benchmark for our analysis.</p>
<p>Ultimately, our goal is to uncover any patterns or trends in the
playlist that might shed light on the question of which culture produces
more romantic music. So let’s put on our headphones, dive into the
playlist, and see what the data has to say!</p>
<hr />
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<div class="figure">
<img src="pics/intro_photo.png" alt="DALL·E 2 generating input 'asian melancholic songs thatgive you sad feeling'" width="100%" height="100%" data-figure-id=fig1 />
<p class="caption">
DALL·E 2 generating input ‘asian melancholic songs thatgive you sad
feeling’
</p>
</div>
</div>
<div id="description" class="section level3">
<h3>Description</h3>
<p><font size="6"> About My </font></p>
<p>There are three playlists chosen for my project in order to answer my
question.</p>
<p><font size="4"> My Brother’s playlist</font></p>
<p>The playlist is named after a Japanese word, “切ない系”
(Setsunai-kei) meaning “melancholic” or “wistful” in English. The
57-song playlist is a collection of songs that convey bittersweet
sentiments through sweet vocals assisted by soft and warm instrumentals.
The playlist is primarily composed of songs sung in Japanese or Korean
but also includes English songs. Despite the difference in language
amongst the songs included, they share the similarity in the melodies of
the songs, often having sweet and charming rings. The vocals of the
songs are also one of the main elements that make the playlist truly
melancholic, as if the artists are whispering to the heart of the
listener.</p>
<p><font size="4">Top 50 South Korea &amp; Top 50 Japan</font></p>
<p>To determine which culture produces more romantic music, I have
decided to use my brother’s playlist of 52 sad love songs from Korea and
Japan as a standard for comparison. In order to assess the relative
romanticism of Korean and Japanese music, I will be comparing my
brother’s playlist with the Top 50 playlists from each country.</p>
<p>By examining the degree of overlap between my brother’s playlist and
the Top 50 playlists from Korea and Japan, I hope to gain insights into
which country’s music is more aligned with my brother’s taste in
romantic music. While it’s important to note that my brother’s playlist
is not necessarily representative of all Korean and Japanese romantic
music, it does provide a useful benchmark for comparison.</p>
<p>Of course, romanticism is a subjective concept and there may be other
factors beyond just cultural origin that influence my brother’s
selection of songs. Nonetheless, I believe that this approach will
provide a useful starting point for exploring the question of which
country’s music is more romantic.</p>
<hr />
<!-- <iframe src="https://open.spotify.com/playlist/5ASx85eUYUG7QmYpiJVI4p" height="380" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe> -->
</div>
<div id="what-makes-a-song-romantic-and-sad" class="section level3">
<h3>What makes a song romantic and sad?</h3>
<p>Explain in academical term what we consider as our target songs.</p>
</div>
</div>
<div id="visual-analysis-of-my" class="section level1 storyboard"
data-icon="fa-signal">
<h1 class="storyboard">Visual analysis of my</h1>
<div id="song-length-in-bar-plot" class="section level3">
<h3>Song length in Bar plot</h3>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" width="576" data-figure-id=fig1 /></p>
<hr />
<p>Upon examining my brother’s playlist and the Top 50 playlists from
Japan and South Korea, I’ve noticed that there are some interesting
differences in the duration of songs. Specifically, my brother’s
playlist consists mostly of songs around 4 minutes in length, while the
Top 50 playlist from Japan has a peak at 3 minutes and a little over 4
minutes, and the Top 50 playlist from Korea peaks at 3 minutes.</p>
</div>
<div id="keys-of-songs" class="section level3">
<h3>Keys of Songs</h3>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" width="576" data-figure-id=fig2 /></p>
<hr />
<p>As I continue to analyze my brother’s playlist and the Top 50
playlists from Japan and South Korea, I’ve noticed some intriguing
differences in the musical keys used by the different artists.</p>
<p>Specifically, my brother’s playlist has a notable concentration of
songs in the A key. Additionally, he has an equal amount of songs in the
C, C#, and D keys. In contrast, the Top 50 playlist from Japan has the
highest concentration of songs in the G key, while the Top 50 playlist
from Korea mainly features songs in the C and C# keys - which is
consistent with the key distribution in my brother’s playlist.</p>
<p>While the key of a song may not directly determine its level of
romanticism, these observations are an interesting starting point.</p>
</div>
<div id="tempo-valence" class="section level3">
<h3>Tempo &amp; Valence</h3>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b2397dc4aa61d156f1e6" style="width:576px;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-b2397dc4aa61d156f1e6">{"x":{"data":[{"x":[74.673,80.924,122.711,90.001,179.913,100.083,178.258,100.873,99.89,94.966,94.984,125.981,118.734,175.818,137.692,150.313,132,79.997,133.329,97.998,98.015,100.013,93.973,185.516,131.632,170.049,83.868,88.044,168.05,171.837,80.004,167.078,136.422,81.99,97.977,129.686,146.603,134.044,134.365,143.678,97.9,141.993,76.946,174.184,99.304,135.724,143.963,67.531,100.012,171.717,167.925,167.877,183.089,97.913,103.32,197.851,92.241],"y":[0.187,0.492,0.142,0.566,0.195,0.487,0.226,0.391,0.514,0.37,0.475,0.463,0.301,0.399,0.237,0.374,0.304,0.32,0.209,0.723,0.773,0.579,0.43,0.584,0.189,0.819,0.346,0.312,0.477,0.406,0.841,0.249,0.549,0.404,0.237,0.247,0.274,0.164,0.187,0.225,0.398,0.422,0.29,0.347,0.264,0.156,0.529,0.11,0.192,0.387,0.418,0.384,0.167,0.638,0.82,0.377,0.375],"text":["tempo:  74.673<br />valence: 0.1870<br />playlist_name: My Brother's playlist","tempo:  80.924<br />valence: 0.4920<br />playlist_name: My Brother's playlist","tempo: 122.711<br />valence: 0.1420<br />playlist_name: My Brother's playlist","tempo:  90.001<br />valence: 0.5660<br />playlist_name: My Brother's playlist","tempo: 179.913<br />valence: 0.1950<br />playlist_name: My Brother's playlist","tempo: 100.083<br />valence: 0.4870<br />playlist_name: My Brother's playlist","tempo: 178.258<br />valence: 0.2260<br />playlist_name: My Brother's playlist","tempo: 100.873<br />valence: 0.3910<br />playlist_name: My Brother's playlist","tempo:  99.890<br />valence: 0.5140<br />playlist_name: My Brother's playlist","tempo:  94.966<br />valence: 0.3700<br />playlist_name: My Brother's playlist","tempo:  94.984<br />valence: 0.4750<br />playlist_name: My Brother's playlist","tempo: 125.981<br />valence: 0.4630<br />playlist_name: My Brother's playlist","tempo: 118.734<br />valence: 0.3010<br />playlist_name: My Brother's playlist","tempo: 175.818<br />valence: 0.3990<br />playlist_name: My Brother's playlist","tempo: 137.692<br />valence: 0.2370<br />playlist_name: My Brother's playlist","tempo: 150.313<br />valence: 0.3740<br />playlist_name: My Brother's playlist","tempo: 132.000<br />valence: 0.3040<br />playlist_name: My Brother's playlist","tempo:  79.997<br />valence: 0.3200<br />playlist_name: My Brother's playlist","tempo: 133.329<br />valence: 0.2090<br />playlist_name: My Brother's playlist","tempo:  97.998<br />valence: 0.7230<br />playlist_name: My Brother's playlist","tempo:  98.015<br />valence: 0.7730<br />playlist_name: My Brother's playlist","tempo: 100.013<br />valence: 0.5790<br />playlist_name: My Brother's playlist","tempo:  93.973<br />valence: 0.4300<br />playlist_name: My Brother's playlist","tempo: 185.516<br />valence: 0.5840<br />playlist_name: My Brother's playlist","tempo: 131.632<br />valence: 0.1890<br />playlist_name: My Brother's playlist","tempo: 170.049<br />valence: 0.8190<br />playlist_name: My Brother's playlist","tempo:  83.868<br />valence: 0.3460<br />playlist_name: My Brother's playlist","tempo:  88.044<br />valence: 0.3120<br />playlist_name: My Brother's playlist","tempo: 168.050<br />valence: 0.4770<br />playlist_name: My Brother's playlist","tempo: 171.837<br />valence: 0.4060<br />playlist_name: My Brother's playlist","tempo:  80.004<br />valence: 0.8410<br />playlist_name: My Brother's playlist","tempo: 167.078<br />valence: 0.2490<br />playlist_name: My Brother's playlist","tempo: 136.422<br />valence: 0.5490<br />playlist_name: My Brother's playlist","tempo:  81.990<br />valence: 0.4040<br />playlist_name: My Brother's playlist","tempo:  97.977<br />valence: 0.2370<br />playlist_name: My Brother's playlist","tempo: 129.686<br />valence: 0.2470<br />playlist_name: My Brother's playlist","tempo: 146.603<br />valence: 0.2740<br />playlist_name: My Brother's playlist","tempo: 134.044<br />valence: 0.1640<br />playlist_name: My Brother's playlist","tempo: 134.365<br />valence: 0.1870<br />playlist_name: My Brother's playlist","tempo: 143.678<br />valence: 0.2250<br />playlist_name: My Brother's playlist","tempo:  97.900<br />valence: 0.3980<br />playlist_name: My Brother's playlist","tempo: 141.993<br />valence: 0.4220<br />playlist_name: My Brother's playlist","tempo:  76.946<br />valence: 0.2900<br />playlist_name: My Brother's playlist","tempo: 174.184<br />valence: 0.3470<br />playlist_name: My Brother's playlist","tempo:  99.304<br />valence: 0.2640<br />playlist_name: My Brother's playlist","tempo: 135.724<br />valence: 0.1560<br />playlist_name: My Brother's playlist","tempo: 143.963<br />valence: 0.5290<br />playlist_name: My Brother's playlist","tempo:  67.531<br />valence: 0.1100<br />playlist_name: My Brother's playlist","tempo: 100.012<br />valence: 0.1920<br />playlist_name: My Brother's playlist","tempo: 171.717<br />valence: 0.3870<br />playlist_name: My Brother's playlist","tempo: 167.925<br />valence: 0.4180<br />playlist_name: My Brother's playlist","tempo: 167.877<br />valence: 0.3840<br />playlist_name: My Brother's playlist","tempo: 183.089<br />valence: 0.1670<br />playlist_name: My Brother's playlist","tempo:  97.913<br />valence: 0.6380<br />playlist_name: My Brother's playlist","tempo: 103.320<br />valence: 0.8200<br />playlist_name: My Brother's playlist","tempo: 197.851<br />valence: 0.3770<br />playlist_name: My Brother's playlist","tempo:  92.241<br />valence: 0.3750<br />playlist_name: My Brother's playlist"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"My Brother's playlist","legendgroup":"My Brother's playlist","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[130,150.015,102.123,118.012,126.956,106.382,123.977,109.976,90.952,101.921,150.082,133.854,103.01,108.106,178.077,84.385,179.833,124.893,175.064,156.057,121.983,145.816,143.975,77.968,171.845,148.089,143.16,96.04,100.006,128.01,89.987,170.045,150.094,152.014,137.024,96.921,207.906,105.025,116.982,137.967,117.968,143.91,140.06,131.975,134.991,74.996,79.953,125.062,170.863,158.078],"y":[0.381,0.638,0.861,0.831,0.739,0.674,0.664,0.784,0.867,0.292,0.349,0.183,0.663,0.524,0.733,0.0706,0.691,0.629,0.451,0.406,0.837,0.424,0.503,0.459,0.652,0.477,0.477,0.698,0.647,0.84,0.404,0.541,0.784,0.308,0.91,0.48,0.713,0.824,0.701,0.624,0.912,0.336,0.538,0.315,0.707,0.487,0.459,0.6,0.38,0.519],"text":["tempo: 130.000<br />valence: 0.3810<br />playlist_name: Top 50 Japan","tempo: 150.015<br />valence: 0.6380<br />playlist_name: Top 50 Japan","tempo: 102.123<br />valence: 0.8610<br />playlist_name: Top 50 Japan","tempo: 118.012<br />valence: 0.8310<br />playlist_name: Top 50 Japan","tempo: 126.956<br />valence: 0.7390<br />playlist_name: Top 50 Japan","tempo: 106.382<br />valence: 0.6740<br />playlist_name: Top 50 Japan","tempo: 123.977<br />valence: 0.6640<br />playlist_name: Top 50 Japan","tempo: 109.976<br />valence: 0.7840<br />playlist_name: Top 50 Japan","tempo:  90.952<br />valence: 0.8670<br />playlist_name: Top 50 Japan","tempo: 101.921<br />valence: 0.2920<br />playlist_name: Top 50 Japan","tempo: 150.082<br />valence: 0.3490<br />playlist_name: Top 50 Japan","tempo: 133.854<br />valence: 0.1830<br />playlist_name: Top 50 Japan","tempo: 103.010<br />valence: 0.6630<br />playlist_name: Top 50 Japan","tempo: 108.106<br />valence: 0.5240<br />playlist_name: Top 50 Japan","tempo: 178.077<br />valence: 0.7330<br />playlist_name: Top 50 Japan","tempo:  84.385<br />valence: 0.0706<br />playlist_name: Top 50 Japan","tempo: 179.833<br />valence: 0.6910<br />playlist_name: Top 50 Japan","tempo: 124.893<br />valence: 0.6290<br />playlist_name: Top 50 Japan","tempo: 175.064<br />valence: 0.4510<br />playlist_name: Top 50 Japan","tempo: 156.057<br />valence: 0.4060<br />playlist_name: Top 50 Japan","tempo: 121.983<br />valence: 0.8370<br />playlist_name: Top 50 Japan","tempo: 145.816<br />valence: 0.4240<br />playlist_name: Top 50 Japan","tempo: 143.975<br />valence: 0.5030<br />playlist_name: Top 50 Japan","tempo:  77.968<br />valence: 0.4590<br />playlist_name: Top 50 Japan","tempo: 171.845<br />valence: 0.6520<br />playlist_name: Top 50 Japan","tempo: 148.089<br />valence: 0.4770<br />playlist_name: Top 50 Japan","tempo: 143.160<br />valence: 0.4770<br />playlist_name: Top 50 Japan","tempo:  96.040<br />valence: 0.6980<br />playlist_name: Top 50 Japan","tempo: 100.006<br />valence: 0.6470<br />playlist_name: Top 50 Japan","tempo: 128.010<br />valence: 0.8400<br />playlist_name: Top 50 Japan","tempo:  89.987<br />valence: 0.4040<br />playlist_name: Top 50 Japan","tempo: 170.045<br />valence: 0.5410<br />playlist_name: Top 50 Japan","tempo: 150.094<br />valence: 0.7840<br />playlist_name: Top 50 Japan","tempo: 152.014<br />valence: 0.3080<br />playlist_name: Top 50 Japan","tempo: 137.024<br />valence: 0.9100<br />playlist_name: Top 50 Japan","tempo:  96.921<br />valence: 0.4800<br />playlist_name: Top 50 Japan","tempo: 207.906<br />valence: 0.7130<br />playlist_name: Top 50 Japan","tempo: 105.025<br />valence: 0.8240<br />playlist_name: Top 50 Japan","tempo: 116.982<br />valence: 0.7010<br />playlist_name: Top 50 Japan","tempo: 137.967<br />valence: 0.6240<br />playlist_name: Top 50 Japan","tempo: 117.968<br />valence: 0.9120<br />playlist_name: Top 50 Japan","tempo: 143.910<br />valence: 0.3360<br />playlist_name: Top 50 Japan","tempo: 140.060<br />valence: 0.5380<br />playlist_name: Top 50 Japan","tempo: 131.975<br />valence: 0.3150<br />playlist_name: Top 50 Japan","tempo: 134.991<br />valence: 0.7070<br />playlist_name: Top 50 Japan","tempo:  74.996<br />valence: 0.4870<br />playlist_name: Top 50 Japan","tempo:  79.953<br />valence: 0.4590<br />playlist_name: Top 50 Japan","tempo: 125.062<br />valence: 0.6000<br />playlist_name: Top 50 Japan","tempo: 170.863<br />valence: 0.3800<br />playlist_name: Top 50 Japan","tempo: 158.078<br />valence: 0.5190<br />playlist_name: Top 50 Japan"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)"}},"hoveron":"points","name":"Top 50 Japan","legendgroup":"Top 50 Japan","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[120.001,132.09,126.956,133.854,102.057,99.976,119.949,86.314,117.06,101.058,78.01,147.02,100.049,104.988,133.096,102.966,105.025,88.98,114.993,94.074,186.073,129.74,119.04,97.031,152.026,186.022,96.033,67.033,97.977,101.921,100.008,88.964,130.94,125.014,131.949,173.93,73.967,156.935,131.298,79.95,179.833,110.862,105.104,117.941,132.962,179.877,117.999,86.957,139.694,131.972],"y":[0.362,0.564,0.739,0.183,0.168,0.783,0.239,0.26,0.872,0.719,0.36,0.499,0.608,0.695,0.657,0.534,0.824,0.418,0.341,0.813,0.713,0.327,0.686,0.652,0.922,0.545,0.616,0.506,0.286,0.292,0.793,0.739,0.273,0.799,0.779,0.662,0.527,0.661,0.36,0.324,0.691,0.609,0.444,0.538,0.857,0.567,0.646,0.373,0.173,0.569],"text":["tempo: 120.001<br />valence: 0.3620<br />playlist_name: Top 50 South Korea","tempo: 132.090<br />valence: 0.5640<br />playlist_name: Top 50 South Korea","tempo: 126.956<br />valence: 0.7390<br />playlist_name: Top 50 South Korea","tempo: 133.854<br />valence: 0.1830<br />playlist_name: Top 50 South Korea","tempo: 102.057<br />valence: 0.1680<br />playlist_name: Top 50 South Korea","tempo:  99.976<br />valence: 0.7830<br />playlist_name: Top 50 South Korea","tempo: 119.949<br />valence: 0.2390<br />playlist_name: Top 50 South Korea","tempo:  86.314<br />valence: 0.2600<br />playlist_name: Top 50 South Korea","tempo: 117.060<br />valence: 0.8720<br />playlist_name: Top 50 South Korea","tempo: 101.058<br />valence: 0.7190<br />playlist_name: Top 50 South Korea","tempo:  78.010<br />valence: 0.3600<br />playlist_name: Top 50 South Korea","tempo: 147.020<br />valence: 0.4990<br />playlist_name: Top 50 South Korea","tempo: 100.049<br />valence: 0.6080<br />playlist_name: Top 50 South Korea","tempo: 104.988<br />valence: 0.6950<br />playlist_name: Top 50 South Korea","tempo: 133.096<br />valence: 0.6570<br />playlist_name: Top 50 South Korea","tempo: 102.966<br />valence: 0.5340<br />playlist_name: Top 50 South Korea","tempo: 105.025<br />valence: 0.8240<br />playlist_name: Top 50 South Korea","tempo:  88.980<br />valence: 0.4180<br />playlist_name: Top 50 South Korea","tempo: 114.993<br />valence: 0.3410<br />playlist_name: Top 50 South Korea","tempo:  94.074<br />valence: 0.8130<br />playlist_name: Top 50 South Korea","tempo: 186.073<br />valence: 0.7130<br />playlist_name: Top 50 South Korea","tempo: 129.740<br />valence: 0.3270<br />playlist_name: Top 50 South Korea","tempo: 119.040<br />valence: 0.6860<br />playlist_name: Top 50 South Korea","tempo:  97.031<br />valence: 0.6520<br />playlist_name: Top 50 South Korea","tempo: 152.026<br />valence: 0.9220<br />playlist_name: Top 50 South Korea","tempo: 186.022<br />valence: 0.5450<br />playlist_name: Top 50 South Korea","tempo:  96.033<br />valence: 0.6160<br />playlist_name: Top 50 South Korea","tempo:  67.033<br />valence: 0.5060<br />playlist_name: Top 50 South Korea","tempo:  97.977<br />valence: 0.2860<br />playlist_name: Top 50 South Korea","tempo: 101.921<br />valence: 0.2920<br />playlist_name: Top 50 South Korea","tempo: 100.008<br />valence: 0.7930<br />playlist_name: Top 50 South Korea","tempo:  88.964<br />valence: 0.7390<br />playlist_name: Top 50 South Korea","tempo: 130.940<br />valence: 0.2730<br />playlist_name: Top 50 South Korea","tempo: 125.014<br />valence: 0.7990<br />playlist_name: Top 50 South Korea","tempo: 131.949<br />valence: 0.7790<br />playlist_name: Top 50 South Korea","tempo: 173.930<br />valence: 0.6620<br />playlist_name: Top 50 South Korea","tempo:  73.967<br />valence: 0.5270<br />playlist_name: Top 50 South Korea","tempo: 156.935<br />valence: 0.6610<br />playlist_name: Top 50 South Korea","tempo: 131.298<br />valence: 0.3600<br />playlist_name: Top 50 South Korea","tempo:  79.950<br />valence: 0.3240<br />playlist_name: Top 50 South Korea","tempo: 179.833<br />valence: 0.6910<br />playlist_name: Top 50 South Korea","tempo: 110.862<br />valence: 0.6090<br />playlist_name: Top 50 South Korea","tempo: 105.104<br />valence: 0.4440<br />playlist_name: Top 50 South Korea","tempo: 117.941<br />valence: 0.5380<br />playlist_name: Top 50 South Korea","tempo: 132.962<br />valence: 0.8570<br />playlist_name: Top 50 South Korea","tempo: 179.877<br />valence: 0.5670<br />playlist_name: Top 50 South Korea","tempo: 117.999<br />valence: 0.6460<br />playlist_name: Top 50 South Korea","tempo:  86.957<br />valence: 0.3730<br />playlist_name: Top 50 South Korea","tempo: 139.694<br />valence: 0.1730<br />playlist_name: Top 50 South Korea","tempo: 131.972<br />valence: 0.5690<br />playlist_name: Top 50 South Korea"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)"}},"hoveron":"points","name":"Top 50 South Korea","legendgroup":"Top 50 South Korea","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":42.6666666666667,"r":7.30593607305936,"b":39.0867579908676,"l":48.9497716894977},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Tempo and Valence distribution among the playlists","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[59.98935,214.94965],"tickmode":"array","ticktext":["100","150","200"],"tickvals":[100,150,200],"categoryorder":"array","categoryarray":["100","150","200"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"tempo","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.02803,0.96457],"tickmode":"array","ticktext":["0.25","0.50","0.75"],"tickvals":[0.25,0.5,0.75],"categoryorder":"array","categoryarray":["0.25","0.50","0.75"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"valence","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"playlist_name","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"10ab93012d290":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"10ab93012d290","visdat":{"10ab93012d290":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<hr />
<p>As I continue to explore the romantic qualities of music from Japan
and South Korea, I’ve identified two key features from Spotify API that
may be particularly relevant: tempo and valence.</p>
<p>When examining my brother’s playlist, which he curated as a
collection of sad love songs, I noticed a preponderance of songs with
lower tempo and valence scores. This aligns with his stated intention
for the playlist and suggests that these features may be indicative of
romantic music as he perceives it.</p>
<p>In contrast, the Top 50 playlists from Japan and South Korea exhibit
a similar distribution of valence scores, centering around 0.50 and
0.75. This may reflect the similarity of popular music trends between
the two countries, particularly in the realm of pop music.</p>
<p>However, I did observe a slightly greater prevalence of songs with
low tempo and valence scores in the Top 50 playlist from South Korea
than in the Top 50 playlist from Japan. Based on this observation, it’s
possible that South Korean music may be somewhat more romantic than
Japanese music. However, it’s important to note that this conclusion is
based on a limited set of data and further analysis would be needed to
confirm it.</p>
</div>
<div id="chromagram" class="section level3">
<h3>Chromagram</h3>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" width="576" data-figure-id=fig3 /></p>
<hr />
<p>We are analyzing the song “All Alone” by DAY6 using the function
get_tidy_audio_analysis(). The chromagram we’re working with has been
normalized and we’re using the Euclidean distance measure. A chromagram
in computational musicology is a visual representation of the
distribution of energy across different musical pitches in an audio
signal. You can thus see which key is prevalent in each time frame. You
can see that in the beginning of the song, strong keys shift
continuously beginning from C, F3, B, A and then D. After 53 second time
mark A key shows to be the most important key of the song.</p>
<p>TIP: Implement two more songs. Explain more on the differences
between different distance measures.</p>
</div>
<div id="ceptogram" class="section level3">
<h3>Ceptogram</h3>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" width="576" data-figure-id=fig4 /></p>
<hr />
<p>A cepstrogram is a visual representation of the cepstral coefficients
of an audio signal. Cepstral analysis is a technique used in signal
processing and acoustics to analyze the spectral content of a signal by
taking the inverse Fourier transform of its logarithm. In a cepstrogram,
the cepstral coefficients are displayed over time, It can reveal
patterns and structures in the spectral content of the signal. I made a
ceptogram of the song ‘As I Wished’ by Urban Zakapa. I used Euclidean
for normalization and root mean square as a summary statistic. We can
see that lower c are appear to be more dominant. (I need a better
explanation here because I am not so sure what this represents.)</p>
</div>
<div id="self-similarity-matrix" class="section level3">
<h3>Self Similarity Matrix</h3>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" width="576" data-figure-id=fig5 /></p>
<hr />
<p>The two self-similarity matrices show chroma- and timbre-based
self-similarity of the song ‘Here I Am Again’ by Yerin Baek. I was sick
and I don’t really know what to say. I will work on this explanation by
15th of March. But I can say that since there are no diagonal lines
there are not much similar time components within the song. The song had
different type of melody throughout the song but I think the overall
vibe was similar so that is so strange. I also see that there is not
much a clear pattern that is coming back and forth, this is also a
strange phenomenon in my opinion. I need to research on this.</p>
</div>
<div id="outliers-and-its-keygrams" class="section level3">
<h3>Outliers and its keygrams</h3>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" width="576" data-figure-id=fig6 /></p>
<hr />
<p>In my brother’s playlist there are also western songs such as “I Will
Always Love You” by Dolly Parton. In this section I will focus on this
song by making a chordgram. The song is in D major but the plot shows
otherwise. It depicts keys above D major. So this is strange.</p>
<p>Another example is “i swear i’ll never leave again” by Keshi. The
song is A major but it also fails to detect that. It shows Eb major is
the most prevalent.</p>
<p>In both cases, it failed to highlight the correct chords. It
highlights somewhere close but it is not accurate. (I need some
explanation why this is the case in the future)</p>
</div>
<div id="track-level-summaries" class="section level3">
<h3>Track-Level Summaries</h3>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" width="576" data-figure-id=fig7 /></p>
<hr />
<p>Overall I can see that my brother’s playlist has higher SD tempo
value than the other two playlists. But this is probably due to the fact
that my brother’s playlist is smaller than the the other two.</p>
</div>
<div id="histogram-of-tempi" class="section level3">
<h3>Histogram of Tempi</h3>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" width="576" data-figure-id=fig8 /></p>
<hr />
<p>Here is a histogram of tempo of each playlists. As you can see, there
is no clear similarities between these three playlists. Each playlist
has different distribution in tempo. However, at just below 100 bpm both
my brother’s playlist and Top 50 Korea have a peak whereas Japan top 50
doesn’t. This indicates that Brother’s playlist is more similar to
Korean than Japanese in terms of tempo.</p>
</div>
<div id="tempogram" class="section level3">
<h3>Tempogram</h3>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<hr />
<p>Over My Dead Body by Drake has the highest tempo in my brother’s
playlist. Although listening to it the background instrumental is not
particularly faster than other songs. However, it is suspected that rap
is effecting the overall tempo of the song. I used windows size of 4 and
hop size of 1 in this tempogram. We see that the bpm is mostly constant
which aligns with how the song also goes. However, BPM of this song
should be around 185. This is not correctly shown in the plot and I
called this plot multiple times but it gave me the same result. Compared
to its self-similarity matrix curve you can see that both …</p>
</div>
<div id="classification" class="section level3">
<h3>Classification</h3>
<div class="knitr-options" data-fig-width="576" data-fig-height="460">

</div>
<p><img src="index_files/figure-html/halloween-1.png" width="576" data-figure-id=fig9 /></p>
<hr />
<p>Here we see a classification matrix of my KNN classifier. This matrix
represents the accurately predicted values. We see that the classifier
predicts my brother’s playlist well as it makes up the largest area. It
does less so in other areas. I changed the k value to 3 and it had no
significant effect. Overall the accuracy of this classifier is below
average.</p>
</div>
</div>
<div id="end-point" class="section level1 storyboard"
data-icon="ion-music-note">
<h1 class="storyboard">End point</h1>
<div id="what-did-i-find" class="section level3">
<h3>What did I find?</h3>
<p>Through our analysis of my brother’s playlist and the Top 50
playlists from Japan and South Korea, we’ve discovered some interesting
differences in the musical features that are commonly associated with
romantic music.</p>
<p>We found that the Top 50 playlists from both countries generally
exhibited a similar distribution of tempo and valence scores, reflecting
similarities in pop music trends. However, the playlists diverged in
other areas: the Top 50 playlist from Japan featured a higher
concentration of songs in the G key and a wider range of song lengths,
while the Top 50 playlist from South Korea had many songs in C and C#
keys and tended to peak at 3 minutes in length.</p>
<p>Based on our analysis, we observed that South Korean music appears to
more closely resemble my brother’s playlist than Japanese music. While
this is a somewhat subjective conclusion, given that it is based on my
brother’s personal tastes and preferences, it suggests that Koreans may
be more romantic than the Japanese in his estimation.</p>
<p>Overall, these findings offer insights into the cultural differences
in romantic music between Japan and South Korea, and may be useful for
those interested in exploring these themes further or curating playlists
in this genre. However, it’s important to note that our conclusions are
based on a relatively small sample size, and further analysis would be
needed to confirm these trends.</p>
</div>
<div id="future-improvements" class="section level3">
<h3>Future Improvements</h3>
<ul>
<li><p>Find better playlists. The results were much better when I picked
romantic song playlists of South Korea and Japan instead of top 50. The
problem is that they were not curated/created by Spotify.</p></li>
<li><p>Use/explore more features and maybe I can calculate similarities
using KNN?</p></li>
</ul>
</div>
</div>

</div>

<script>
$(document).ready(function() {
  // add bootstrap table styles to pandoc tables
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed table-sm');

  // initialize mathjax
  var script = document.createElement("script");
  script.type = "text/javascript";
  script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
  document.getElementsByTagName("head")[0].appendChild(script);

});
</script>

<script type="text/javascript">
$(document).ready(function () {
  FlexDashboard.init({
    fillPage: true,
    orientation: "columns",
    storyboard: true,
    defaultFigWidth: 576,
    defaultFigHeight: 460,
    defaultFigWidthMobile: 360,
    defaultFigHeightMobile: 460,
    resize_reload: true
  });
  var navbar = $(".navbar").first();
  var body = $("body").first();
  var sidebar = $(".section.sidebar").first();
  function addNavbarPadding() {
    var navHeight = navbar.outerHeight();
    body.css("padding-top", (navHeight + 8) + "px");
    sidebar.css("top", navHeight + "px");
    var resizeEvent = window.document.createEvent("UIEvents");
    resizeEvent.initUIEvent("resize", true, false, window, 0);
    window.dispatchEvent(resizeEvent);
  }
  if (!window.Shiny) setTimeout(addNavbarPadding, 100);
  $(document).on("shiny:idle", function() {
    setTimeout(addNavbarPadding, 50);
  });
});
</script>

</body>
</html>
